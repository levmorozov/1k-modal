!function(e){"use strict";function i(){return t.length?t[t.length-1]:null}var o,l=e(document.documentElement),n=document,t=[];e.m1k=function(i,o){e.extend(this,e.fn.m1k.defaults,o,e(i).data()),this.init(i,o)},e.m1k.prototype={constructor:e.m1k,id:"m1k",single:!0,escClose:!0,clickClose:!0,close:"x",init:function(s,c){var d=this,r='<div class="% %-hide"><div class="%-content">';if(d.close&&(r+='<div class="%-close" aria-label="Close">'+d.close+"</div>"),r+="</div></div>",void 0===o&&(o=e('<div class="'+d.id+'-root"></div>'),e("body").append(o)),d.box=e(r.replace(/%/g,d.id)).clone(),d.single)for(;null!==i();)i().close();return t.push(d),d.el=e(s),d.box.find("."+d.id+"-content").append(d.el),o.append(d.box),l.addClass("with-"+d.id),d._pa=n.activeElement,d._pa.blur&&d._pa.blur(),d.el.show(),d.box.removeClass(d.id+"-hide"),d.el.trigger(d.id+":after-open",[d,d.el]),d.box.on("click."+d.id,function(i){var o=e(i.target);(d.clickClose&&o.is("."+d.id)||o.closest(d.id+"-close").length)&&(d._close(i),i.preventDefault())}),d.box.find("."+d.id+"-close").click(function(){return i()._close(),!1}),e(n).off("keydown."+d.id).on("keydown."+d.id,function(e){var o=i();27===e.which&&o.escClose&&o._close()}),d},_close:function(){t.pop();var o=this;o.el.hide().appendTo(e("body")),o.box.remove(),o.box=null,o._pa.focus(),null===i()&&l.removeClass("with-"+o.id),o.el.trigger(o.id+":after-close",o)}},e.m1k.close=function(e){var o=i();if(null!==o)return e&&e.preventDefault(),o._close(),o.el},e.fn.m1k=function(i){return 1===this.length&&new e.m1k(this,i),this}}(jQuery);